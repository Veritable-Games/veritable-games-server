#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Detect parser changes and trigger re-indexing
PARSER_FILE="frontend/src/lib/godot/parser-service.ts"

if git diff --name-only HEAD~1 HEAD | grep -q "$PARSER_FILE"; then
  echo ""
  echo "ğŸ” Parser changes detected in last commit!"
  echo "ğŸ“Š Triggering Godot script re-indexing..."
  echo ""

  cd frontend && npm run godot:reindex-all || true

  echo ""
  echo "âœ… Re-index complete"
else
  echo "âœ“ No parser changes, skipping re-index"
fi
